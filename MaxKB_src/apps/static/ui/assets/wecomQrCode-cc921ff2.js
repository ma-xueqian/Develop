import{cp as xe,dB as Le,cq as j,d1 as Ae,cx as Re,cy as Ie,dh as We,dN as Ne,cY as Oe,cR as qe}from"./index-5edadd4e.js";const E=typeof window<"u"?window:void 0,P=typeof document<"u"?document:void 0,p=typeof navigator<"u"?navigator:void 0,M=typeof location<"u"?location:void 0;function Be(){return(M==null?void 0:M.href)||""}const v=(p==null?void 0:p.userAgent)||"",Fe=(p==null?void 0:p.platform)||"";var be;(be=v==null?void 0:v.match(/wxwork\/([\d.]+)/i))==null||be[1];ze();function ze(){const e=(p==null?void 0:p.maxTouchPoints)??1,t=/Mac/i.test(Fe);return t&&e>2?{isMac:!1,isIOS:!0}:{isMac:t,isIOS:/\b(iPhone|iPad|iPod)\b/i.test(v)}}const Ve={config:"preVerifyJsApi",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",onMenuShareWechat:"menu:share:wechat",onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"imagePreview",getLocation:"geoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest",openEnterpriseRedPacket:"getRecevieBizHongBaoRequest",startSearchBeacons:"startMonitoringBeacons",stopSearchBeacons:"stopMonitoringBeacons",onSearchBeacons:"onBeaconsInRange",consumeAndShareCard:"consumedShareCard",openAddress:"editAddress",getBrandWCPayRequest:"getBrandWCPayRequest"};for(const e of Object.keys(Ve));function De(...e){console.error("[wwsdk]",...e)}Be();function je(e,t,n){if(Ye(e))try{return e.call(n,t)}catch(o){De(o)}}function Ye(e){return typeof e=="function"}let Y=!!(E!=null&&E.WeixinJSBridge);Promise.resolve();Y||new Promise(e=>{P==null||P.addEventListener("WeixinJSBridgeReady",()=>{Y=!0,e()})});function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var H,J,K,Q,G,$,U,Z,X,ee,te,ne,oe,ae,re,ie,se,ce,le,de,ue,pe,fe,me,he,ge,_e;function He(e){const t=document.createElement("iframe"),{style:n}=t;n.display="block",n.border="none",n.background="transparent",t.referrerPolicy="origin",t.setAttribute("frameborder","0"),t.setAttribute("allowtransparency","true");const o=Je(e);return o&&o.appendChild(t),t}function Je(e){return typeof e=="string"?document.querySelector(e):e}(function(e){e.CLProximityUnknown="0",e.CLProximityImmediate="1",e.CLProximityNear="2",e.CLProximityFar="3"})(H||(H={})),function(e){e.wgs84="wgs84",e.gcj02="gcj02"}(J||(J={})),function(e){e.wifi="wifi",e.network2g="2g",e.network3g="3g",e.network4g="4g",e.none="none",e.unknown="unknown"}(K||(K={})),function(e){e.video="video",e.image="image",e.file="file",e.video_and_image="video_and_image"}(Q||(Q={})),function(e){e.video="video",e.image="image",e.file="file"}(G||(G={})),function(e){e.original="original",e.compressed="compressed"}($||($={})),function(e){e.album="album",e.camera="camera"}(U||(U={})),function(e){e.normal="normal",e.batch="batch",e.front="front",e.batch_front="batch_front"}(Z||(Z={})),function(e){e[e.common=0]="common",e[e.corp_training=1]="corp_training",e[e.edu_normal_class=2]="edu_normal_class",e[e.edu_small_class=3]="edu_small_class"}(X||(X={})),function(e){e[e.other=0]="other",e[e.doc=3]="doc",e[e.sheet=4]="sheet",e[e.form=5]="form",e[e.slide=6]="slide",e[e.mindmap=7]="mindmap",e[e.flowchart=8]="flowchart",e[e.smartsheet=10]="smartsheet"}(ee||(ee={})),function(e){e[e.normal=0]="normal",e[e.scan=1]="scan"}(te||(te={})),function(e){e[e.chat=0]="chat",e[e.qrcode=1]="qrcode"}(ne||(ne={})),function(e){e.contact_profile="contact_profile",e.single_chat_tools="single_chat_tools",e.group_chat_tools="group_chat_tools",e.chat_attachment="chat_attachment",e.single_kf_tools="single_kf_tools",e.chain_single_chat_tools="chain_single_chat_tools",e.chain_group_chat_tools="chain_group_chat_tools",e.internal_group_chat_board="internal_group_chat_board",e.normal="normal"}(oe||(oe={})),function(e){e.permission="permission",e.datazone_permission="datazone_permission"}(ae||(ae={})),function(e){e.release="release",e.trial="trial",e.develop="develop"}(re||(re={})),function(e){e[e.internal=1]="internal",e[e.external=2]="external"}(ie||(ie={})),function(e){e[e.mediaid=1]="mediaid",e[e.url=2]="url",e[e.localId=4]="localId"}(se||(se={})),function(e){e.None="None",e.HWOpenTalk="HWOpenTalk",e.VoIP="VoIP",e.SystemCall="SystemCall"}(ce||(ce={})),function(e){e.qrCode="qrCode",e.barCode="barCode"}(le||(le={})),function(e){e.single="single",e.multi="multi"}(de||(de={})),function(e){e.department="department",e.user="user"}(ue||(ue={})),function(e){e.single="single",e.multi="multi"}(pe||(pe={})),function(e){e.department="department",e.user="user"}(fe||(fe={})),function(e){e[e.all=0]="all",e[e.unselected=1]="unselected"}(me||(me={})),function(e){e.single="single",e.multi="multi"}(he||(he={})),function(e){e.create_approval="10001",e.view_approval="10002"}(ge||(ge={})),function(e){e.link="link",e.text="text"}(_e||(_e={}));const Ke=$e();let Qe=0;function Ge(){return`${Ke}-${Qe++}`}function $e(){return Math.random().toString(36).slice(2)}function Ue(e){return e&&typeof e=="object"?{...e,message:e.message,stack:e.stack}:e}function we(e){try{return typeof e=="string"?JSON.parse(e):e}catch{}}function Ze(e,t){const n=new Map;return{invoke:function(o,a){return a!=null&&a.dropResult?(e({type:"ww-iframe-handle:call",args:o},a),Promise.resolve(void 0)):new Promise((l,d)=>{const s=Ge();n.set(s,{resolve:l,reject:d}),e({type:"ww-iframe-handle:call",uid:s,args:o},a)})},handleCallMessage:async function(o,a){if(!o.uid)return t(o.args,a);try{e({type:"ww-iframe-handle:response",uid:o.uid,kind:"resolve",args:await t(o.args,a)})}catch(l){throw e({type:"ww-iframe-handle:response",uid:o.uid,kind:"reject",args:Ue(l)}),l}},handleResponseMessage:function(o){const a=n.get(o.uid);a&&(a[o.kind](o.args),n.delete(o.uid))}}}function Xe(e,t,n){const o=[];let a=!1,l=!1;function d(i){if(i.origin!==t||e.contentWindow!==i.source)return;const r=we(i.data);typeof(r==null?void 0:r.type)=="string"&&r.type.startsWith("ww-iframe-handle:")&&D(r,i)}window.addEventListener("message",d);const s=new MessageChannel;s.port1.onmessage=i=>{D(we(i.data),i)};const{invoke:c,handleCallMessage:k,handleResponseMessage:f}=Ze(function(i,r){a?w(i,r):o.push({msg:i,opts:r})},n);function D(i,r){switch(i.type){case"ww-iframe-handle:ready":return function(y){if(!a){a=!0,y.supportChannel&&(w({type:"ww-iframe-handle:set-port",port:s.port2},{transfer:[s.port2],serialize:!1}),l=!0);for(const g of o)w(g.msg,g.opts)}}(i);case"ww-iframe-handle:call":return k(i,r);case"ww-iframe-handle:response":return void f(i)}}function w(i,r){var g;const y=(r==null?void 0:r.serialize)===!1?i:JSON.stringify(i);l?s.port1.postMessage(y,r==null?void 0:r.transfer):(g=e.contentWindow)==null||g.postMessage(y,t,r==null?void 0:r.transfer)}return e.addEventListener("load",()=>{a||w({type:"ww-iframe-handle:init"})}),{el:e,invoke:c,dispose:function(){window.removeEventListener("message",d),s.port1.onmessage=null}}}function et(e,t,n){je(t[e.name],e.payload||e.data,n)}for(var bt={null:null,true:!0,false:!1,NaN:NaN,Infinity:1/0},tt="await break case catch class const continue debugger default delete do else enum export extends false finally for function if import in instanceof new null return super switch this throw true try typeof var void while with yield".split(" "),nt={},x=0,ye=tt;x<ye.length;x++){var ot=ye[x];nt[ot]=!0}var N,C,O,m;(function(e){e.serviceApp="ServiceApp",e.corpApp="CorpApp"})(N||(N={})),function(e){e.zh="zh",e.en="en"}(C||(C={})),function(e){e.top="top",e.callback="callback",e.self="self"}(O||(O={})),function(e){e.middle="middle",e.small="small"}(m||(m={}));const ve={[m.middle]:["480px","416px"],[m.small]:["320px","380px"]};function at(e){var s;const{width:t,height:n}=rt((s=e.params)==null?void 0:s.panel_size),o=He(e.el),{style:a}=o;a.width=t,a.height=n;const{dispose:l}=Xe(o,"https://login.work.weixin.qq.com",c=>{if(c.type==="call")return et(c,e);throw new Error(`Unknown message type '${c.type}'`)}),d=new URL("https://login.work.weixin.qq.com/wwlogin/sso/login");for(const c of Object.keys(e.params||{}))d.searchParams.set(c,e.params[c]);return d.searchParams.set("version","2.3.1"),o.src=d.href,{el:o,unmount(){var c;l(),(c=o.parentNode)==null||c.removeChild(o)}}}function rt(e=m.middle){const t=ve[e]||ve[m.middle];return{width:t[0],height:t[1]}}function ke(e){return typeof Symbol=="function"?Symbol(e):e}var Ce;(function(e){e[e.int32=1]="int32",e[e.float64=2]="float64",e[e.boolean=3]="boolean",e[e.null=4]="null",e[e[void 0]=5]="undefined",e[e.valueRef=6]="valueRef"})(Ce||(Ce={}));var Te,Se;(function(e){e[e.set=1]="set",e[e.call=2]="call",e[e.dispose=3]="dispose"})(Te||(Te={})),function(e){e[e.value=1]="value",e[e.ref=2]="ref"}(Se||(Se={}));const F=ke("__WECOM_REFLECT_ID__");function it(e,t){return t.get?t.get.call(e):t.value}function Ee(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function T(e,t){return it(e,Ee(e,t,"get"))}function st(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function S(e,t,n){st(e,t),t.set(e,n)}function ct(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}function b(e,t,n){return ct(e,Ee(e,t,"set"),n),n}const q=new WeakMap,B=new WeakMap;function z(e,t){q.set(e,t),B.set(t,e)}function Pe(e){return q.has(e)?q.get(e):e}function Me(e){return B.has(e)?B.get(e):e}var L=new WeakMap,A=new WeakMap;let lt=F;class dt{setTransform(t){T(this,A).setTransform(t),T(this,L).call(this,"setTransform",[t])}constructor(t,n){_(this,lt,void 0),S(this,L,{writable:!0,value:void 0}),S(this,A,{writable:!0,value:void 0}),b(this,L,t),b(this,A,n),t.bind(this),z(this,n)}}var R=new WeakMap,I=new WeakMap;let ut=F;class W{addColorStop(t,n){T(this,I).addColorStop(t,n),T(this,R).call(this,"addColorStop",[t,n])}constructor(t,n){_(this,ut,void 0),S(this,R,{writable:!0,value:void 0}),S(this,I,{writable:!0,value:void 0}),b(this,R,t),b(this,I,n),t.bind(this),z(this,n)}}const pt=["fillStyle","filter","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","imageSmoothingQuality","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","strokeStyle"],ft=["direction","font","fontKerning","fontStretch","fontVariantCaps","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","textAlign","textBaseline","textRendering","wordSpacing"],mt=["arc","arcTo","beginPath","bezierCurveTo","clip","closePath","ellipse","lineTo","moveTo","quadraticCurveTo","rect","reset","resetTransform","restore","rotate","roundRect","save","scale","setLineDash","setTransform","transform","translate"],ht=["clearRect","drawFocusIfNeeded","drawImage","fill","fillRect","fillText","stroke","strokeRect","strokeText"],gt=["getContextAttributes","getLineDash","getTransform","isContextLost","isPointInPath","isPointInStroke","measureText"],_t=[["createConicGradient",W],["createLinearGradient",W],["createPattern",dt],["createRadialGradient",W]],u=ke("__WECOM_INTERNAL__");let wt=u,yt=F;class vt{constructor(t,n,o){_(this,"canvas",void 0),_(this,wt,void 0),_(this,yt,void 0),this.canvas=t,this[u]={store:n,native:o,props:Object.create(null)},n.bind(this),z(this,o)}}const h=vt.prototype;for(const e of pt)Object.defineProperty(h,e,{configurable:!0,enumerable:!0,get(){const{native:t,props:n}=this[u];return n[e]??Me(t[e])},set(t){const{store:n,props:o}=this[u];o[e]=Pe(t),n.set(this,e,t)}});for(const e of ft)Object.defineProperty(h,e,{configurable:!0,enumerable:!0,get(){return Me(this[u].native[e])},set(t){const{store:n,native:o}=this[u];o[e]=Pe(t),n.set(this,e,t)}});for(const e of gt)h[e]=function(...t){const{native:n}=this[u];return V(n,e,t)};for(const e of mt)h[e]=function(...t){const{store:n,native:o}=this[u];V(o,e,t),n.call(this,e,t)};for(const e of ht)h[e]=function(...t){const{store:n}=this[u];n.call(this,e,t)};for(const[e,t]of _t)h[e]=function(...n){const{store:o,native:a}=this[u],l=V(a,e,n),d=new t(o,l);return o.call(this,e,n,d),d};function V(e,t,n){switch(n.length){case 1:return e[t](n[0]);case 2:return e[t](n[0],n[1]);case 3:return e[t](n[0],n[1],n[2]);case 4:return e[t](n[0],n[1],n[2],n[3]);case 5:return e[t](n[0],n[1],n[2],n[3],n[4]);case 6:return e[t](n[0],n[1],n[2],n[3],n[4],n[5]);default:return e[t](...n)}}const Ct={id:"wecom-qr",class:"wecom-qr",style:{"margin-left":"50px"}},Tt=xe({__name:"wecomQrCode",props:{config:{}},setup(e){const t=Le(),n=j({}),o=j({isWeComLogin:!1}),{user:a}=Ae(),l=e;return(async()=>{await We();const s={corpId:l.config.corp_id,agentId:l.config.agent_id},c=localStorage.getItem("MaxKB-locale")||Ne()||"en-US",k=window.location.origin;try{n.value=at({el:"#wecom-qr",params:{login_type:N.corpApp,appid:s.corpId||"",agentid:s.agentId,redirect_uri:k,state:"fit2cloud-wecom-qr",lang:c==="zh-CN"||c==="zh-Hant"?C.zh:C.en,redirect_type:O.callback,panel_size:m.small},onCheckWeComLogin:o.value,async onLoginSuccess({code:f}){a.wecomCallback(f).then(()=>{setTimeout(()=>{t.push({name:"home"})})})},onLoginFail(f){Oe(`${f.errMsg}`)}})}catch(f){console.error("Error initializing login panel:",f)}})(),(s,c)=>(Re(),Ie("div",Ct))}});const kt=qe(Tt,[["__scopeId","data-v-85dec9fa"]]);export{kt as default};
