import{cp as I,cq as p,cu as n,cx as C,cF as R,cA as e,cB as _,cz as t,cE as N,cK as V,cJ as u,dU as Z,cQ as K,dV as G,cZ as H,d3 as se,d0 as Q,cU as X,cv as ee,cV as O,cN as L,cP as ie,cr as re,cy as ae,cC as te,cD as de,cS as ue,cY as pe}from"./index-5edadd4e.js";const ce={class:"dialog-footer"},xe=I({__name:"AIModeParamSettingDialog",emits:["refresh"],setup(T,{expose:S,emit:x}){const $=p([]),h=x,c=p(),d=p({}),v=p(!1),o=p(!1),r=(m,g)=>g?K.getModelParamsForm(g,m,o):G.getModelParamsForm(m,o),w=(m,g,D)=>{d.value={},r(m,g).then(l=>{var a;$.value=l.data,(a=c.value)==null||a.render($.value,D)}),v.value=!0},k=(m,g)=>{r(m,g).then(s=>{$.value=s.data;const l=s.data.map(a=>a.show_default_value===!1?{[a.field]:void 0}:{[a.field]:a.default_value}).reduce((a,i)=>({...a,...i}),{});h("refresh",l)})},q=async()=>{var m;(m=c.value)==null||m.validate().then(()=>{h("refresh",d.value),v.value=!1})};return S({open:w,reset_default:k}),(m,g)=>{const D=n("el-button"),s=n("el-dialog");return C(),R(s,{"align-center":"",title:m.$t("common.paramSetting"),modelValue:v.value,"onUpdate:modelValue":g[2]||(g[2]=l=>v.value=l),style:{width:"550px"},"append-to-body":"","destroy-on-close":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[_("span",ce,[t(D,{onClick:g[1]||(g[1]=N(l=>v.value=!1,["prevent"]))},{default:e(()=>[V(u(m.$t("common.cancel")),1)]),_:1}),t(D,{type:"primary",onClick:q,loading:o.value},{default:e(()=>[V(u(m.$t("common.confirm")),1)]),_:1},8,["loading"])])]),default:e(()=>[t(Z,{modelValue:d.value,"onUpdate:modelValue":g[0]||(g[0]=l=>d.value=l),model:d.value,"label-position":"top","require-asterisk-position":"right",render_data:$.value,ref_key:"dynamicsFormRef",ref:c},null,8,["modelValue","model","render_data"])]),_:1},8,["title","modelValue"])}}}),me={class:"p-16"},_e={class:"mb-4"},fe={class:"mb-4"},ve={class:"mb-4"},ge={class:"flex align-center"},be={class:"mr-4"},he={class:"flex align-center"},we={class:"mr-4"},ye={class:"dialog-footer p-16"},Ae=I({__name:"ParamSettingDialog",emits:["refresh"],setup(T,{expose:S,emit:x}){const $=x,h=p(),c=p(),d={ai_questioning:"{question}",designated_answer:H("views.application.applicationForm.dialog.designated_answer")},v=H("views.application.applicationForm.dialog.defaultPrompt1",{question:"{question}"})+"<data></data>"+H("views.application.applicationForm.dialog.defaultPrompt2"),o=p({dataset_setting:{search_mode:"embedding",top_n:3,similarity:.6,max_paragraph_char_number:5e3,no_references_setting:{status:"ai_questioning",value:"{question}"}},problem_optimization:!1,problem_optimization_prompt:v}),r=p({ai_questioning:d.ai_questioning,designated_answer:d.designated_answer}),w=se({ai_questioning:[{required:!0,message:H("views.application.applicationForm.form.aiModel.placeholder"),trigger:"blur"}],designated_answer:[{required:!0,message:H("views.application.applicationForm.form.prompt.requiredMessage"),trigger:"blur"}]}),k=p(!1),q=p(!1),m=p(!1);Q(k,l=>{var a;l||(r.value={ai_questioning:d.ai_questioning,designated_answer:d.designated_answer},(a=c.value)==null||a.clearValidate())});const g=(l,a)=>{m.value=ie(a),o.value={dataset_setting:{...l.dataset_setting},problem_optimization:l.problem_optimization,problem_optimization_prompt:l.problem_optimization_prompt},m.value||(r.value[o.value.dataset_setting.no_references_setting.status]=o.value.dataset_setting.no_references_setting.value),k.value=!0},D=async l=>{if(m.value)delete o.value.no_references_setting,$("refresh",o.value),k.value=!1;else{if(!l)return;await l.validate((a,i)=>{a&&(o.value.dataset_setting.no_references_setting.value=r.value[o.value.dataset_setting.no_references_setting.status],$("refresh",o.value),k.value=!1)})}};function s(l){l==="keywords"?o.value.dataset_setting.similarity=0:o.value.dataset_setting.similarity=.6}return S({open:g}),(l,a)=>{const i=n("el-text"),b=n("el-radio"),F=n("el-card"),U=n("el-radio-group"),f=n("el-form-item"),A=n("AppIcon"),P=n("el-tooltip"),M=n("el-input-number"),j=n("el-col"),W=n("el-row"),J=n("el-slider"),z=n("el-input"),B=n("el-form"),E=n("el-switch"),le=n("el-scrollbar"),Y=n("el-button"),oe=n("el-dialog"),ne=X("loading");return C(),R(oe,{"align-center":"",title:l.$t("common.paramSetting"),class:"param-dialog",modelValue:k.value,"onUpdate:modelValue":a[11]||(a[11]=y=>k.value=y),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[_("span",ye,[t(Y,{onClick:a[9]||(a[9]=N(y=>k.value=!1,["prevent"]))},{default:e(()=>[V(u(l.$t("common.cancel")),1)]),_:1}),t(Y,{type:"primary",onClick:a[10]||(a[10]=y=>D(c.value)),loading:q.value},{default:e(()=>[V(u(l.$t("common.save")),1)]),_:1},8,["loading"])])]),default:e(()=>[t(le,{"max-height":"550"},{default:e(()=>[_("div",me,[ee((C(),R(B,{"label-position":"top",ref_key:"paramFormRef",ref:h,model:o.value},{default:e(()=>[t(f,{label:l.$t("views.application.applicationForm.dialog.selectSearchMode")},{default:e(()=>[t(U,{modelValue:o.value.dataset_setting.search_mode,"onUpdate:modelValue":a[0]||(a[0]=y=>o.value.dataset_setting.search_mode=y),class:"card__radio",onChange:s},{default:e(()=>[t(F,{shadow:"never",class:O(["mb-16",o.value.search_mode==="embedding"?"active":""])},{default:e(()=>[t(b,{value:"embedding",size:"large"},{default:e(()=>[_("p",_e,u(l.$t("views.application.applicationForm.dialog.vectorSearch")),1),t(i,{type:"info"},{default:e(()=>[V(u(l.$t("views.application.applicationForm.dialog.vectorSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),t(F,{shadow:"never",class:O(["mb-16",o.value.dataset_setting.search_mode==="keywords"?"active":""])},{default:e(()=>[t(b,{value:"keywords",size:"large"},{default:e(()=>[_("p",fe,u(l.$t("views.application.applicationForm.dialog.fullTextSearch")),1),t(i,{type:"info"},{default:e(()=>[V(u(l.$t("views.application.applicationForm.dialog.fullTextSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),t(F,{shadow:"never",class:O(o.value.dataset_setting.search_mode==="blend"?"active":"")},{default:e(()=>[t(b,{value:"blend",size:"large"},{default:e(()=>[_("p",ve,u(l.$t("views.application.applicationForm.dialog.hybridSearch")),1),t(i,{type:"info"},{default:e(()=>[V(u(l.$t("views.application.applicationForm.dialog.hybridSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),t(W,{gutter:20},{default:e(()=>[t(j,{span:12},{default:e(()=>[t(f,null,{label:e(()=>[_("div",ge,[_("span",be,u(l.$t("views.application.applicationForm.dialog.similarityThreshold")),1),t(P,{effect:"dark",content:l.$t("views.application.applicationForm.dialog.similarityTooltip"),placement:"right"},{default:e(()=>[t(A,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])])]),default:e(()=>[t(M,{modelValue:o.value.dataset_setting.similarity,"onUpdate:modelValue":a[1]||(a[1]=y=>o.value.dataset_setting.similarity=y),min:0,max:o.value.dataset_setting.search_mode==="blend"?2:1,precision:3,step:.1,"value-on-clear":0,"controls-position":"right",class:"w-full"},null,8,["modelValue","max"])]),_:1})]),_:1}),t(j,{span:12},{default:e(()=>[t(f,{label:l.$t("views.application.applicationForm.dialog.topReferences")},{default:e(()=>[t(M,{modelValue:o.value.dataset_setting.top_n,"onUpdate:modelValue":a[2]||(a[2]=y=>o.value.dataset_setting.top_n=y),min:1,max:1e4,"value-on-clear":1,"controls-position":"right",class:"w-full"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),t(f,{label:l.$t("views.application.applicationForm.dialog.maxCharacters")},{default:e(()=>[t(J,{modelValue:o.value.dataset_setting.max_paragraph_char_number,"onUpdate:modelValue":a[3]||(a[3]=y=>o.value.dataset_setting.max_paragraph_char_number=y),"show-input":"","show-input-controls":!1,min:500,max:1e5,class:"custom-slider"},null,8,["modelValue"])]),_:1},8,["label"]),m.value?L("",!0):(C(),R(f,{key:0,label:l.$t("views.application.applicationForm.dialog.noReferencesAction")},{default:e(()=>[t(B,{"label-position":"top",ref_key:"noReferencesformRef",ref:c,model:r.value,rules:w,"hide-required-asterisk":!0,class:"w-full"},{default:e(()=>[t(U,{modelValue:o.value.dataset_setting.no_references_setting.status,"onUpdate:modelValue":a[5]||(a[5]=y=>o.value.dataset_setting.no_references_setting.status=y),class:"radio-block-avatar"},{default:e(()=>[t(b,{value:"ai_questioning"},{default:e(()=>[_("p",null,u(l.$t("views.application.applicationForm.dialog.continueQuestioning")),1)]),_:1}),t(b,{value:"designated_answer"},{default:e(()=>[_("p",null,u(l.$t("views.application.applicationForm.dialog.provideAnswer")),1),o.value.dataset_setting.no_references_setting.status==="designated_answer"?(C(),R(f,{key:0,prop:"designated_answer"},{default:e(()=>[t(z,{modelValue:r.value.designated_answer,"onUpdate:modelValue":a[4]||(a[4]=y=>r.value.designated_answer=y),rows:2,type:"textarea",maxlength:"2048",placeholder:d.designated_answer},null,8,["modelValue","placeholder"])]),_:1})):L("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model","rules"])]),_:1},8,["label"])),m.value?L("",!0):(C(),R(f,{key:1,onClick:a[7]||(a[7]=N(()=>{},["prevent"]))},{label:e(()=>[_("div",he,[_("span",we,u(l.$t("views.application.applicationForm.form.problemOptimization.label")),1)])]),default:e(()=>[t(E,{size:"small",modelValue:o.value.problem_optimization,"onUpdate:modelValue":a[6]||(a[6]=y=>o.value.problem_optimization=y)},null,8,["modelValue"])]),_:1})),o.value.problem_optimization?(C(),R(f,{key:2,label:l.$t("views.application.applicationForm.form.prompt.label")},{default:e(()=>[t(z,{modelValue:o.value.problem_optimization_prompt,"onUpdate:modelValue":a[8]||(a[8]=y=>o.value.problem_optimization_prompt=y),rows:6,type:"textarea",maxlength:"2048",placeholder:v},null,8,["modelValue"])]),_:1},8,["label"])):L("",!0)]),_:1},8,["model"])),[[ne,q.value]])])]),_:1})]),_:1},8,["title","modelValue"])}}}),Ve={class:"flex-between mb-8"},$e=["id"],ke={class:"flex align-center mr-8"},Fe={class:"flex-between"},Ce={class:"max-height"},Ue=["title"],De={class:"flex-between"},Re={class:"flex"},Te=I({__name:"AddDatasetDialog",props:{data:{type:Array,default:()=>[]},loading:Boolean},emits:["addData","refresh"],setup(T,{expose:S,emit:x}){const $=T,h=x,c=p(!1),d=p([]),v=p(""),o=p(""),r=p([]),w=re(()=>v.value?r.value.filter(s=>s.embedding_mode_id===v.value):r.value);Q(c,s=>{s||(d.value=[],v.value="",o.value="")}),Q(o,s=>{s?r.value=$.data.filter(l=>l.name.includes(s)):r.value=$.data});function k(){d.value.length>0?v.value=$.data.filter(s=>s.id===d.value[0])[0].embedding_mode_id:d.value.length===0&&(v.value="")}function q(){d.value=[],v.value=""}const m=s=>{r.value=$.data,d.value=s,d.value.length>0&&(v.value=$.data.filter(l=>l.id===d.value[0])[0].embedding_mode_id),c.value=!0},g=()=>{h("addData",d.value),c.value=!1},D=()=>{h("refresh")};return S({open:m}),(s,l)=>{const a=n("Refresh"),i=n("el-icon"),b=n("el-button"),F=n("el-divider"),U=n("el-text"),f=n("el-input"),A=n("CardCheckbox"),P=n("el-col"),M=n("el-row"),j=n("el-scrollbar"),W=n("el-dialog"),J=X("loading");return C(),R(W,{title:s.$t("views.application.applicationForm.dialog.addDataset"),modelValue:c.value,"onUpdate:modelValue":l[3]||(l[3]=z=>c.value=z),width:"600","append-to-body":"",class:"addDataset-dialog","align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1},{header:e(({titleId:z,titleClass:B})=>[_("div",Ve,[_("h4",{id:z,class:O(B)},u(s.$t("views.application.applicationForm.dialog.addDataset")),11,$e),_("div",ke,[t(b,{link:"",class:"ml-16",onClick:D},{default:e(()=>[t(i,{class:"mr-4"},{default:e(()=>[t(a)]),_:1}),V(u(s.$t("common.refresh")),1)]),_:1}),t(F,{direction:"vertical"})])]),_("div",Fe,[t(U,{type:"info",class:"color-secondary"},{default:e(()=>[V(u(s.$t("views.application.applicationForm.dialog.addDatasetPlaceholder")),1)]),_:1}),t(f,{modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=E=>o.value=E),placeholder:s.$t("common.search"),"prefix-icon":"Search",class:"w-240",clearable:""},null,8,["modelValue","placeholder"])])]),footer:e(()=>[_("div",De,[_("div",Re,[d.value.length>0?(C(),R(U,{key:0,type:"info",class:"color-secondary mr-8"},{default:e(()=>[V(u(s.$t("views.application.applicationForm.dialog.selected"))+" "+u(d.value.length)+" "+u(s.$t("views.application.applicationForm.dialog.countDataset")),1)]),_:1})):L("",!0),d.value.length>0?(C(),R(b,{key:1,link:"",type:"primary",onClick:q},{default:e(()=>[V(u(s.$t("common.clear")),1)]),_:1})):L("",!0)]),_("span",null,[t(b,{onClick:l[2]||(l[2]=N(z=>c.value=!1,["prevent"]))},{default:e(()=>[V(u(s.$t("common.cancel")),1)]),_:1}),t(b,{type:"primary",onClick:g},{default:e(()=>[V(u(s.$t("common.confirm")),1)]),_:1})])])]),default:e(()=>[t(j,null,{default:e(()=>[_("div",Ce,[ee((C(),R(M,{gutter:12},{default:e(()=>[(C(!0),ae(te,null,de(w.value,(z,B)=>(C(),R(P,{span:12,key:B,class:"mb-16"},{default:e(()=>[t(A,{"value-field":"id",data:z,modelValue:d.value,"onUpdate:modelValue":l[1]||(l[1]=E=>d.value=E),onChange:k},{default:e(()=>[_("span",{class:"ellipsis cursor",title:z.name},u(z.name),9,Ue)]),_:2},1032,["data","modelValue"])]),_:2},1024))),128))]),_:1})),[[J,T.loading]])])]),_:1})]),_:1},8,["title","modelValue"])}}});const qe={class:"flex-between"},Pe={class:"dialog-footer"},Me=I({__name:"TTSModeParamSettingDialog",emits:["refresh"],setup(T,{expose:S,emit:x}){const{params:{id:$}}=ue.config.globalProperties.$route,h=p(""),c=p([]),d=x,v=p(),o=p({}),r=p(!1),w=p(!1),k=p(!1),q=(a,i)=>i?K.getModelParamsForm(i,a,w):G.getModelParamsForm(a,w),m=(a,i,b)=>{o.value={},h.value=a,q(a,i).then(U=>{var A;c.value=U.data;const f=U.data.map(P=>({[P.field]:P.show_default_value!==!1?P.default_value:void 0})).reduce((P,M)=>({...P,...M}),{});b&&Object.keys(b).forEach(P=>{P in f||delete b[P]}),b={...f,...b},(A=v.value)==null||A.render(c.value,b)}),r.value=!0},g=(a,i)=>{q(a,i).then(F=>{c.value=F.data;const U=F.data.map(f=>({[f.field]:f.show_default_value!==!1?f.default_value:void 0})).reduce((f,A)=>({...f,...A}),{});d("refresh",U)})},D=async()=>{var a;(a=v.value)==null||a.validate().then(()=>{d("refresh",o.value),r.value=!1})},s=p(null),l=()=>{const a={...o.value,tts_model_id:h.value};K.playDemoText($,a,k).then(async i=>{if(i.type==="application/json"){const U=await i.text();pe(U);return}const b=new Blob([i],{type:"audio/mp3"}),F=URL.createObjectURL(b);s.value instanceof HTMLAudioElement?(s.value.src=F,s.value.play()):console.error("audioPlayer.value is not an instance of HTMLAudioElement")}).catch(i=>{console.log("err: ",i)})};return S({open:m,reset_default:g}),(a,i)=>{const b=n("AppIcon"),F=n("el-button"),U=n("el-dialog");return C(),ae(te,null,[t(U,{"align-center":"",title:a.$t("common.paramSetting"),modelValue:r.value,"onUpdate:modelValue":i[2]||(i[2]=f=>r.value=f),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[_("div",qe,[t(F,{onClick:l,loading:k.value},{default:e(()=>[t(b,{iconName:"app-video-play",class:"mr-4"}),V(" "+u(a.$t("views.application.applicationForm.form.voicePlay.listeningTest")),1)]),_:1},8,["loading"]),_("span",Pe,[t(F,{onClick:i[1]||(i[1]=N(f=>r.value=!1,["prevent"]))},{default:e(()=>[V(u(a.$t("common.cancel")),1)]),_:1}),t(F,{type:"primary",onClick:D,loading:w.value},{default:e(()=>[V(u(a.$t("common.confirm")),1)]),_:1},8,["loading"])])])]),default:e(()=>[t(Z,{modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=f=>o.value=f),model:o.value,"label-position":"top","require-asterisk-position":"right",render_data:c.value,ref_key:"dynamicsFormRef",ref:v},null,8,["modelValue","model","render_data"])]),_:1},8,["title","modelValue"]),_("audio",{ref_key:"audioPlayer",ref:s,controls:"",hidden:"hidden"},null,512)],64)}}}),ze={class:"dialog-footer p-16"},Be=I({__name:"ReasoningParamSettingDialog",emits:["refresh"],setup(T,{expose:S,emit:x}){const $=x,h=p({reasoning_content_start:"<think>",reasoning_content_end:"</think>"}),c=p(!1),d=p(!1);Q(c,r=>{r||(h.value={reasoning_content_start:"<think>",reasoning_content_end:"</think>"})});const v=r=>{h.value={...h.value,...r},c.value=!0},o=()=>{$("refresh",h.value),c.value=!1};return S({open:v}),(r,w)=>{const k=n("el-text"),q=n("el-input"),m=n("el-form-item"),g=n("el-col"),D=n("el-row"),s=n("el-form"),l=n("el-button"),a=n("el-dialog");return C(),R(a,{"align-center":"",title:r.$t("common.setting"),class:"param-dialog",modelValue:c.value,"onUpdate:modelValue":w[4]||(w[4]=i=>c.value=i),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:e(()=>[_("span",ze,[t(l,{onClick:w[2]||(w[2]=N(i=>c.value=!1,["prevent"]))},{default:e(()=>[V(u(r.$t("common.cancel")),1)]),_:1}),t(l,{type:"primary",onClick:w[3]||(w[3]=i=>o()),loading:d.value},{default:e(()=>[V(u(r.$t("common.save")),1)]),_:1},8,["loading"])])]),default:e(()=>[t(s,{"label-position":"top",ref:"paramFormRef",model:h.value,class:"p-12-16"},{default:e(()=>[t(k,{type:"info",class:"color-secondary"},{default:e(()=>[V(u(r.$t("views.application.applicationForm.form.reasoningContent.tooltip")),1)]),_:1}),t(D,{class:"mt-16",gutter:20},{default:e(()=>[t(g,{span:12},{default:e(()=>[t(m,{label:r.$t("views.application.applicationForm.form.reasoningContent.start")},{default:e(()=>[t(q,{type:"textarea",modelValue:h.value.reasoning_content_start,"onUpdate:modelValue":w[0]||(w[0]=i=>h.value.reasoning_content_start=i),rows:6,maxlength:"50",placeholder:"<think>"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),t(g,{span:12},{default:e(()=>[t(m,{label:r.$t("views.application.applicationForm.form.reasoningContent.end")},{default:e(()=>[t(q,{type:"textarea",modelValue:h.value.reasoning_content_end,"onUpdate:modelValue":w[1]||(w[1]=i=>h.value.reasoning_content_end=i),rows:6,maxlength:"50",placeholder:"</think>"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])}}});export{xe as _,Be as a,Me as b,Ae as c,Te as d};
