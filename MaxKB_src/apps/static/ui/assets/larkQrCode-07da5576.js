import{cp as u,fj as m,ct as g,cx as h,cy as f,cB as e,dw as w,cJ as k,cC as _}from"./index-5edadd4e.js";const x={class:"flex-center mb-16"},C=u({__name:"larkQrCode",props:{config:{}},setup(n){const{load:c}=m("https://lf-package-cn.feishucdn.com/obj/feishu-static/lark/passport/qrcode/LarkSSOSDKWebQRCode-1.0.3.js"),a=n,d=async()=>{if(!await c(!0)){console.error("飞书二维码 SDK 加载失败");return}const t={agentId:a.config.app_key,appSecret:a.config.app_secret},p=encodeURIComponent(`${window.location.origin}/api/feishu`),r=`https://passport.feishu.cn/suite/passport/oauth/authorize?client_id=${t.agentId}&redirect_uri=${p}&response_type=code&state=fit2cloud-lark-qr`,i=window.QRLogin({id:"lark-qr",goto:r,width:"266",height:"266",style:"width:280px;height:280px;border:1px solid #e8e8e8;margin:0 auto;border-radius:8px;"});window.addEventListener("message",async o=>{if(i.matchOrigin(o.origin)&&i.matchData(o.data)){const l=o.data.tmp_code;window.location.href=`${r}&tmp_code=${l}`}})};return g(()=>{d()}),(s,t)=>(h(),f(_,null,[e("div",x,[t[0]||(t[0]=e("img",{src:w,alt:"",width:"24px",class:"mr-4"},null,-1)),e("h2",null,k(s.$t("views.system.authentication.scanTheQRCode.larkQrCode")),1)]),t[1]||(t[1]=e("div",{id:"lark-qr",class:"lark-qrName"},null,-1))],64))}});export{C as default};
