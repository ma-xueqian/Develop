import{cp as L,d1 as N,dB as S,dz as R,cq as u,ct as U,dK as A,cZ as t,cu as l,cU as D,cv as T,cx as x,cF as I,cA as a,cz as o,cB as m,cJ as w,cK as C,cH as g,cN as K,dQ as j,dj as E}from"./index-5edadd4e.js";const G={class:"mb-24"},H={class:"mb-24"},J={class:"mb-24"},Q={class:"operate-container mt-12"},W=L({__name:"index",setup(Z){const{user:c}=N(),p=S(),M=R(),{params:{code:f,email:_}}=M,e=u({password:"",re_password:"",email:"",code:""});U(()=>{f&&_?(e.value.code=f,e.value.email=_):p.push("forgot_password")}),A(()=>{d.value=!0,c.asyncGetProfile().then(()=>{d.value=!1})});const k=u({password:[{required:!0,message:t("views.user.userForm.form.re_password.requiredMessage"),trigger:"blur"},{min:6,max:20,message:t("views.user.userForm.form.password.lengthMessage"),trigger:"blur"}],re_password:[{required:!0,message:t("views.user.userForm.form.re_password.requiredMessage"),trigger:"blur"},{min:6,max:20,message:t("views.user.userForm.form.password.lengthMessage"),trigger:"blur"},{validator:(s,r,n)=>{e.value.password!=e.value.re_password?n(new Error(t("views.user.userForm.form.re_password.validatorMessage"))):n()},trigger:"blur"}]}),v=u(),d=u(!1),h=u(!1),P=()=>{var s;(s=v.value)==null||s.validate().then(()=>j.resetPassword(e.value,h)).then(()=>{E(t("common.modifySuccess")),p.push({name:"login"})})};return(s,r)=>{const n=l("el-input"),y=l("el-form-item"),$=l("el-form"),b=l("el-button"),z=l("LoginContainer"),B=l("login-layout"),q=D("loading");return d.value?K("",!0):T((x(),I(B,{key:0},{default:a(()=>{var F,V;return[o(z,{subTitle:(F=g(c).themeInfo)!=null&&F.slogan?(V=g(c).themeInfo)==null?void 0:V.slogan:s.$t("views.system.theme.defaultSlogan")},{default:a(()=>[m("h2",G,w(s.$t("views.login.resetPassword")),1),o($,{class:"reset-password-form",ref_key:"resetPasswordFormRef",ref:v,model:e.value,rules:k.value},{default:a(()=>[m("div",H,[o(y,{prop:"password"},{default:a(()=>[o(n,{type:"password",size:"large",class:"input-item",modelValue:e.value.password,"onUpdate:modelValue":r[0]||(r[0]=i=>e.value.password=i),placeholder:s.$t("views.user.userForm.form.password.placeholder"),"show-password":""},null,8,["modelValue","placeholder"])]),_:1})]),m("div",J,[o(y,{prop:"re_password"},{default:a(()=>[o(n,{type:"password",size:"large",class:"input-item",modelValue:e.value.re_password,"onUpdate:modelValue":r[1]||(r[1]=i=>e.value.re_password=i),placeholder:s.$t("views.user.userForm.form.re_password.placeholder"),"show-password":""},null,8,["modelValue","placeholder"])]),_:1})])]),_:1},8,["model","rules"]),o(b,{size:"large",type:"primary",class:"w-full",onClick:P},{default:a(()=>[C(w(s.$t("common.confirm")),1)]),_:1}),m("div",Q,[o(b,{size:"large",class:"register",onClick:r[2]||(r[2]=i=>g(p).push("/login")),link:"",type:"primary",icon:"ArrowLeft"},{default:a(()=>[C(w(s.$t("views.login.buttons.backLogin")),1)]),_:1})])]),_:1},8,["subTitle"])]}),_:1})),[[q,d.value||h.value]])}}});export{W as default};
